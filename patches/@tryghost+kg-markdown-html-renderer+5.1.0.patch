diff --git a/node_modules/@tryghost/kg-markdown-html-renderer/lib/markdown-html-renderer.js b/node_modules/@tryghost/kg-markdown-html-renderer/lib/markdown-html-renderer.js
index 42b8bfe..90036f7 100644
--- a/node_modules/@tryghost/kg-markdown-html-renderer/lib/markdown-html-renderer.js
+++ b/node_modules/@tryghost/kg-markdown-html-renderer/lib/markdown-html-renderer.js
@@ -1,4 +1,5 @@
 const MarkdownIt = require('markdown-it');
+const {createHighlightFunc, katexPlugin, useContainer} = require('@traptitech/traq-markdown-it');
 const semver = require('semver');
 
 const renderers = {};
@@ -66,7 +67,7 @@ const selectRenderer = function (options) {
             return renderers['<4.x'];
         }
 
-        const markdownIt = new MarkdownIt({html: true, breaks: true, linkify: true})
+        const markdownIt = new MarkdownIt({highlight: createHighlightFunc('blog-code'), html: true, breaks: true, linkify: true})
             .use(require('markdown-it-footnote'))
             .use(require('markdown-it-lazy-headers'))
             .use(require('markdown-it-mark'))
@@ -76,6 +77,11 @@ const selectRenderer = function (options) {
         markdownIt.linkify.set({
             fuzzyLink: false
         });
+        markdownIt.use(katexPlugin, {
+            output: 'html'
+        });
+        useContainer(markdownIt);
+            
 
         renderers['<4.x'] = markdownIt;
         return markdownIt;
@@ -84,7 +90,7 @@ const selectRenderer = function (options) {
             return renderers.latest;
         }
 
-        const markdownIt = new MarkdownIt({html: true, breaks: true, linkify: true})
+        const markdownIt = new MarkdownIt({highlight: createHighlightFunc('blog-code'), html: true, breaks: true, linkify: true})
             .use(require('markdown-it-footnote'))
             .use(require('markdown-it-lazy-headers'))
             .use(require('markdown-it-mark'))
@@ -94,14 +100,18 @@ const selectRenderer = function (options) {
         markdownIt.linkify.set({
             fuzzyLink: false
         });
+        markdownIt.use(katexPlugin, {
+            output: 'html'
+        });
+        useContainer(markdownIt);
 
         renderers.latest = markdownIt;
         return markdownIt;
     }
 };
-
+const getRandom = () => Math.random().toString(36).slice(2, 9);
 module.exports = {
     render: function (markdown, options = {}) {
-        return selectRenderer(options).render(markdown);
+        return selectRenderer(options).render(markdown, {docId: getRandom()});
     }
 };
